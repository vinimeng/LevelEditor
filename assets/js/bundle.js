(()=>{"use strict";var e={"./assets/ts/graphics/spritesheet.cheatsheet.ts":(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SPRITESCOORD=void 0,t.SPRITESCOORD={wall:{wall_top_left:[16,0,16,16],wall_top_mid:[16,0,16,16],wall_top_right:[16,0,16,16],wall_left:[16,16,16,16],wall_mid:[32,16,16,16],wall_right:[48,16,16,16],wall_fountain_top:[64,0,16,16],wall_fountain_mid_red_anim_1:[64,16,16,16],wall_fountain_mid_red_anim_2:[80,16,16,16],wall_fountain_mid_red_anim_3:[96,16,16,16],wall_fountain_basin_red_anim_1:[64,32,16,16],wall_fountain_basin_red_anim_2:[80,32,16,16],wall_fountain_basin_red_anim_3:[96,32,16,16],wall_fountain_mid_blue_anim_1:[64,48,16,16],wall_fountain_mid_blue_anim_2:[80,48,16,16],wall_fountain_mid_blue_anim_3:[96,48,16,16],wall_fountain_basin_blue_anim_1:[64,64,16,16],wall_fountain_basin_blue_anim_2:[80,64,16,16],wall_fountain_basin_blue_anim_3:[96,64,16,16],wall_hole_1:[48,32,16,16],wall_hole_2:[48,48,16,16],wall_banner_red:[16,32,16,16],wall_banner_blue:[32,32,16,16],wall_banner_green:[16,48,16,16],wall_banner_yellow:[32,48,16,16],wall_column_top:[96,80,16,16],wall_column_mid:[96,96,16,16],wall_column_base:[96,112,16,16],wall_goo:[64,80,16,16],wall_side_top_left:[0,112,16,16],wall_side_top_right:[16,112,16,16],wall_side_mid_left:[0,128,16,16],wall_side_mid_right:[16,128,16,16],wall_side_front_left:[0,144,16,16],wall_side_front_right:[16,144,16,16],wall_corner_top_left:[32,112,16,16],wall_corner_top_right:[48,112,16,16],wall_corner_left:[32,128,16,16],wall_corner_right:[48,128,16,16],wall_corner_bottom_left:[32,144,16,16],wall_corner_bottom_right:[48,144,16,16],wall_corner_front_left:[32,160,16,16],wall_corner_front_right:[48,160,16,16],wall_inner_corner_l_top_left:[80,128,16,16],wall_inner_corner_l_top_right:[64,128,16,16],wall_inner_corner_mid_left:[80,144,16,16],wall_inner_corner_mid_right:[64,144,16,16],wall_inner_corner_t_top_left:[80,160,16,16],wall_inner_corner_t_top_right:[64,160,16,16],crate:[288,298,16,22],column_top:[80,80,16,16],column_mid:[80,96,16,16],column_base:[80,112,16,16]},floor:{floor_1:[16,64,16,16],floor_2:[32,64,16,16],floor_3:[48,64,16,16],floor_4:[16,80,16,16],floor_5:[32,80,16,16],floor_6:[48,80,16,16],floor_7:[16,96,16,16],floor_8:[32,96,16,16],wall_goo_base:[64,96,16,16],skull:[288,320,16,16]},interactable:{floor_ladder:[48,96,16,16],hole:[96,144,16,16],edge:[96,128,16,16]},interactable_anim:{spikes:[16,176,16,16],switch_red:[16,192,16,16],switch_blue:[48,192,16,16],lever:[80,192,16,16],chest_empty:[320,288,16,16],chest_full:[320,304,16,16],chest_mimic:[320,320,16,16],coin:[288,272,8,8]},doors:{doors_all:[16,221,64,35],doors_frame_left:[16,224,16,32],doors_frame_top:[32,221,32,3],"doors_frame_right:":[63,224,16,32],doors_leaf_closed:[32,224,32,32],doors_leaf_open:[80,224,32,32]},weapon:{weapon_knife:[293,18,6,13],weapon_rusty_sword:[307,26,10,21],weapon_regular_sword:[323,26,10,21],weapon_red_gem_sword:[339,26,10,21],weapon_big_hammer:[291,42,10,37],weapon_hammer:[307,55,10,24],weapon_baton_with_spikes:[323,57,10,22],weapon_mace:[339,55,10,24],weapon_katana:[293,82,6,29],weapon_saw_sword:[307,86,10,25],weapon_anime_sword:[322,81,12,30],weapon_axe:[341,90,9,21],weapon_machete:[294,121,5,22],weapon_cleaver:[310,124,8,19],weapon_duel_sword:[325,113,9,30],weapon_knight_sword:[339,114,10,29],weapon_golden_sword:[291,153,10,22],weapon_lavish_sword:[307,145,10,30],weapon_red_magic_staff:[324,145,8,30],weapon_green_magic_staff:[340,145,8,30],weapon_spear:[293,177,6,30]},potion:{flask_big_red:[288,224,16,16],flask_big_blue:[304,224,16,16],flask_big_green:[320,224,16,16],flask_big_yellow:[336,224,16,16],flask_red:[288,240,16,16],flask_blue:[304,240,16,16],flask_green:[320,240,16,16],flask_yellow:[336,240,16,16]},enemy:{tiny_zombie:[368,16,16,16],goblin:[368,32,16,16],imp:[368,48,16,16],skelet:[368,80,16,16],muddy:[368,112,16,16],swampy:[432,112,16,16],zombie:[368,144,16,16],ice_zombie:[432,144,16,16],masked_orc:[368,172,16,20],orc_warrior:[368,204,16,20],orc_shaman:[368,236,16,20],necromancer:[368,268,16,20],wogol:[368,300,16,20],chort:[368,328,16,24],big_zombie:[16,270,32,34],ogre:[16,320,32,32],big_demon:[16,364,32,36]},player:[128,228,16,28]}},"./assets/ts/graphics/spritesheet.ts":function(e,t,n){var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(s,i){function l(e){try{r(a.next(e))}catch(e){i(e)}}function o(e){try{r(a.throw(e))}catch(e){i(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,o)}r((a=a.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=n("./assets/ts/misc/constants.ts"),i=n("./assets/ts/graphics/spritesheet.cheatsheet.ts");class l{loadSprites(){return a(this,void 0,void 0,(function*(){const e=yield this.setSpritesheet();let t=yield this.cutSprite(e,i.SPRITESCOORD.player[0],i.SPRITESCOORD.player[1],i.SPRITESCOORD.player[2],i.SPRITESCOORD.player[3]);l.player={name:"player",sprite:t};for(const t in i.SPRITESCOORD.wall){const n=i.SPRITESCOORD.wall[t],a={name:t,sprite:yield this.cutSprite(e,n[0],n[1],n[2],n[3])};l.wall.push(a)}for(const t in i.SPRITESCOORD.floor){const n=i.SPRITESCOORD.floor[t],a={name:t,sprite:yield this.cutSprite(e,n[0],n[1],n[2],n[3])};l.floor.push(a)}for(const t in i.SPRITESCOORD.interactable){const n=i.SPRITESCOORD.interactable[t],a={name:t,sprite:yield this.cutSprite(e,n[0],n[1],n[2],n[3])};l.interactable.push(a)}for(const t in i.SPRITESCOORD.interactable_anim){const n=i.SPRITESCOORD.interactable_anim[t],a={name:t,sprite:yield this.cutSprite(e,n[0],n[1],n[2],n[3])};l.interactableAnim.push(a)}for(const t in i.SPRITESCOORD.doors){const n=i.SPRITESCOORD.doors[t],a={name:t,sprite:yield this.cutSprite(e,n[0],n[1],n[2],n[3])};l.doors.push(a)}for(const t in i.SPRITESCOORD.weapon){const n=i.SPRITESCOORD.weapon[t],a={name:t,sprite:yield this.cutSprite(e,n[0],n[1],n[2],n[3])};l.weapon.push(a)}for(const t in i.SPRITESCOORD.potion){const n=i.SPRITESCOORD.potion[t],a={name:t,sprite:yield this.cutSprite(e,n[0],n[1],n[2],n[3])};l.potion.push(a)}for(const t in i.SPRITESCOORD.enemy){const n=i.SPRITESCOORD.enemy[t],a={name:t,sprite:yield this.cutSprite(e,n[0],n[1],n[2],n[3])};l.enemy.push(a)}}))}setSpritesheet(){const e=document.createElement("img");return new Promise(((t,n)=>{e.onload=()=>t(e),e.onerror=n,e.src=s.SPRITESHEET}))}cutSprite(e,t,n,a,s){return createImageBitmap(e,t,n,a,s)}}t.default=l,l.wall=new Array,l.floor=new Array,l.interactable=new Array,l.interactableAnim=new Array,l.doors=new Array,l.weapon=new Array,l.potion=new Array,l.enemy=new Array},"./assets/ts/main.ts":function(e,t,n){var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(s,i){function l(e){try{r(a.next(e))}catch(e){i(e)}}function o(e){try{r(a.throw(e))}catch(e){i(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,o)}r((a=a.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=s(n("./assets/ts/graphics/spritesheet.ts")),l=n("./assets/ts/misc/constants.ts"),o=s(n("./assets/ts/misc/html.ts")),r=s(n("./assets/ts/world/element.ts"));class c{constructor(){this.spritesheet=new i.default,this.appDiv=document.getElementById("app"),this.canvas=document.getElementById("canvas"),this.context2D=this.canvas.getContext("2d"),this.scale=this.determineScale(),this.state=l.GameState.PLAY,this.html=new o.default(this.scale),this.isRunning=!1}main(){return a(this,void 0,void 0,(function*(){yield this.loadAssets(),this.html.createElements(),this.initializeEvents(),this.adjustCanvas(),this.run()}))}tick(){c.elements.forEach(((e,t)=>{e.tick()}))}render(){c.elements.forEach(((e,t)=>{e.render(this.context2D)}))}run(){let e=this,t=0,n=0;this.isRunning=!0,window.requestAnimationFrame((function a(s){e.tick(),e.render(),"block"===e.html.spanFPS.style.display&&(t++,s-n>1e3&&(e.html.spanFPS.innerText=`${t}fps`,t=0,n=s)),e.isRunning&&window.requestAnimationFrame(a)}))}adjustCanvas(){this.canvas.width=l.WIDTH*this.scale,this.canvas.height=l.HEIGHT*this.scale,this.context2D.fillStyle="black",this.context2D.fillRect(0,0,l.WIDTH*this.scale,l.HEIGHT*this.scale),this.context2D.scale(this.scale,this.scale),this.context2D.imageSmoothingEnabled=!1}determineScale(){const e=this.appDiv.offsetWidth,t=this.appDiv.offsetHeight;let n=e/l.WIDTH;return n>=1&&(n=Math.floor(n),(l.WIDTH*n>e||l.HEIGHT*n>t)&&(n-=1)),n<1&&n>=.75?n=.75:n<.75&&n>=.5?n=.5:n<.5&&(n=.25),n}initializeEvents(){window.addEventListener("resize",(()=>{this.scale=this.determineScale(),this.adjustCanvas()})),this.canvas.addEventListener("dragover",(e=>(e.preventDefault(),!1))),this.canvas.addEventListener("drop",(e=>{const t=Number(c.dragged.dataset.index),n=String(c.dragged.dataset.array),a=c.dragged.parentElement?c.dragged.parentElement.scrollTop:0,s=(e.offsetX-c.dragEvent.clientX+c.dragged.offsetLeft)/this.scale,l=(e.offsetY-c.dragEvent.clientY+c.dragged.offsetTop-a)/this.scale;switch(n){case"wall":const e=i.default.wall[t].name,n=i.default.wall[t].sprite;c.elements.push(new r.default(s,l,n.width,n.height,e,"wall",n));break;case"floor":const a=i.default.floor[t].name,o=i.default.floor[t].sprite;c.elements.push(new r.default(s,l,o.width,o.height,a,"floor",o));break;case"interactable":const d=i.default.interactable[t].name,m=i.default.interactable[t].sprite;c.elements.push(new r.default(s,l,m.width,m.height,d,"interactable",m));break;case"interactableAnim":const p=i.default.interactableAnim[t].name,_=i.default.interactableAnim[t].sprite;c.elements.push(new r.default(s,l,_.width,_.height,p,"interactableAnim",_));break;case"doors":const h=i.default.doors[t].name,u=i.default.doors[t].sprite;c.elements.push(new r.default(s,l,u.width,u.height,h,"doors",u));break;case"weapon":const f=i.default.weapon[t].name,w=i.default.weapon[t].sprite;c.elements.push(new r.default(s,l,w.width,w.height,f,"weapon",w));break;case"potion":const E=i.default.potion[t].name,b=i.default.potion[t].sprite;c.elements.push(new r.default(s,l,b.width,b.height,E,"potion",b));break;case"enemy":const g=i.default.enemy[t].name,y=i.default.enemy[t].sprite;c.elements.push(new r.default(s,l,y.width,y.height,g,"enemy",y));break;case"player":const S=i.default.player.name,v=i.default.player.sprite;c.elements.push(new r.default(s,l,v.width,v.height,S,"enemy",v))}}))}loadAssets(){return a(this,void 0,void 0,(function*(){yield this.spritesheet.loadSprites()}))}}t.default=c,c.elements=new Array;(new c).main()},"./assets/ts/misc/constants.ts":(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GameState=t.TILE_SIZE=t.SPRITESHEET=t.HEIGHT=t.WIDTH=void 0,t.WIDTH=320,t.HEIGHT=180,t.SPRITESHEET="./assets/img/spritesheet.png",t.TILE_SIZE=16,function(e){e[e.INITIALIZING=0]="INITIALIZING",e[e.MAINMENU=1]="MAINMENU",e[e.PLAY=2]="PLAY",e[e.CUTSCENE=3]="CUTSCENE",e[e.PAUSEMENU=4]="PAUSEMENU",e[e.ENDING=5]="ENDING"}(t.GameState||(t.GameState={}))},"./assets/ts/misc/html.ts":function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=a(n("./assets/ts/graphics/spritesheet.ts")),i=a(n("./assets/ts/main.ts"));t.default=class{constructor(e){this.spanFPS=document.getElementById("fpsCounter"),this.btnCredits=document.getElementById("btnCredits"),this.modalCredits=document.getElementById("modalCredits"),this.btnToggleFPS=document.getElementById("toggleFPS"),this.elements=document.getElementById("elements"),this.scale=e,this.spanFPS.style.display="none",this.modalCredits.style.display="none",this.initializeEvents()}initializeEvents(){this.btnCredits.addEventListener("click",(()=>{"none"===this.modalCredits.style.display?this.modalCredits.style.display="block":this.modalCredits.style.display="none"})),this.btnToggleFPS.addEventListener("click",(()=>{"block"===this.spanFPS.style.display?this.spanFPS.style.display="none":this.spanFPS.style.display="block"}))}createElements(){const e=document.createElement("div");e.className="break";const t=document.createElement("span");t.innerHTML="Wall:";const n=document.createElement("div");n.className="break",this.elements.append(e),this.elements.append(t),this.elements.append(n),s.default.wall.forEach(((e,t)=>{this.appendElements(e,t,"wall")}));const a=document.createElement("div");a.className="break";const i=document.createElement("span");i.innerHTML="Floor:";const l=document.createElement("div");l.className="break",this.elements.append(a),this.elements.append(i),this.elements.append(l),s.default.floor.forEach(((e,t)=>{this.appendElements(e,t,"floor")}));const o=document.createElement("div");o.className="break";const r=document.createElement("span");r.innerHTML="Interactable:";const c=document.createElement("div");c.className="break",this.elements.append(o),this.elements.append(r),this.elements.append(c),s.default.interactable.forEach(((e,t)=>{this.appendElements(e,t,"interactable")}));const d=document.createElement("div");d.className="break";const m=document.createElement("span");m.innerHTML="InteractableAnim:";const p=document.createElement("div");p.className="break",this.elements.append(d),this.elements.append(m),this.elements.append(p),s.default.interactableAnim.forEach(((e,t)=>{this.appendElements(e,t,"interactableAnim")}));const _=document.createElement("div");_.className="break";const h=document.createElement("span");h.innerHTML="Doors:";const u=document.createElement("div");u.className="break",this.elements.append(_),this.elements.append(h),this.elements.append(u),s.default.doors.forEach(((e,t)=>{this.appendElements(e,t,"doors")}));const f=document.createElement("div");f.className="break";const w=document.createElement("span");w.innerHTML="Weapon:";const E=document.createElement("div");E.className="break",this.elements.append(f),this.elements.append(w),this.elements.append(E),s.default.weapon.forEach(((e,t)=>{this.appendElements(e,t,"weapon")}));const b=document.createElement("div");b.className="break";const g=document.createElement("span");g.innerHTML="Potion:";const y=document.createElement("div");y.className="break",this.elements.append(b),this.elements.append(g),this.elements.append(y),s.default.potion.forEach(((e,t)=>{this.appendElements(e,t,"potion")}));const S=document.createElement("div");S.className="break";const v=document.createElement("span");v.innerHTML="Enemy:";const I=document.createElement("div");I.className="break",this.elements.append(S),this.elements.append(v),this.elements.append(I),s.default.enemy.forEach(((e,t)=>{this.appendElements(e,t,"enemy")}));const T=document.createElement("div");T.className="break";const k=document.createElement("span");k.innerHTML="Player:";const P=document.createElement("div");P.className="break",this.elements.append(T),this.elements.append(k),this.elements.append(P),this.appendElements(s.default.player,0,"player")}appendElements(e,t,n){const a=document.createElement("canvas");a.draggable=!0,a.width=e.sprite.width*this.scale,a.height=e.sprite.height*this.scale,a.style.margin="5px",a.title=e.name,a.id=e.name,a.dataset.index=""+t,a.dataset.array=n,a.addEventListener("dragstart",(e=>{i.default.dragged=a,i.default.dragEvent=e}));const s=a.getContext("2d");s.scale(this.scale,this.scale),s.imageSmoothingEnabled=!1,s.drawImage(e.sprite,0,0),this.elements.append(a)}}},"./assets/ts/world/element.ts":(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t,n,a,s,i,l){this.x=e,this.y=t,this.width=n,this.height=a,this.id=s,this.type=i,this.sprite=l}tick(){}render(e){e.drawImage(this.sprite,this.x,this.y,this.width,this.height)}}}},t={};(function n(a){var s=t[a];if(void 0!==s)return s.exports;var i=t[a]={exports:{}};return e[a].call(i.exports,i,i.exports,n),i.exports})("./assets/ts/main.ts")})();
//# sourceMappingURL=bundle.js.map